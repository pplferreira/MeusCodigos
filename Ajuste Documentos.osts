{"version":"0.2.0","body":"function main(workbook: ExcelScript.Workbook, Documento: string) {\n\nlet varTamanho: number;\nlet varTipoDocumento: string;\n\n  Documento = Documento.replace(/\\D/g, '');\n  varTamanho = Documento.length;\n  \nswitch (varTamanho){\n\n  case 11:  \n    // aplica a máscara do CPF\n    Documento = Documento.replace(/(\\d{3})(\\d{3})(\\d{3})(\\d{2})/, '$1.$2.$3-$4');\n    // tipo de documento CPF\n    varTipoDocumento = \"CPF\";\n  break;\n\n  case 14: \n      // aplica a máscara do CNPJ\n      Documento = Documento.replace(/(\\d{2})(\\d{3})(\\d{3})(\\d{4})(\\d{2})/, '$1.$2.$3/$4-$5');\n      // tipo de documento CNPJ\n      varTipoDocumento = \"CNPJ\";\n  break;\n\n  default:\n      // retorna string original\n      Documento = '';\n      // tipo de documento 'Desconhecido'\n      varTipoDocumento = \"Desconhecido\";\n  break;\n\n}\n\n // retorna o documento formatado\n  return {\n    Documento, Tipo: varTipoDocumento, Qtd: varTamanho} ;\n  \n}\n","description":"","parameterInfo":"{\"originalParameterOrder\":[{\"name\":\"Documento\",\"index\":0}],\"parameterSchema\":{\"type\":\"object\",\"required\":[\"Documento\"],\"properties\":{\"Documento\":{\"type\":\"string\"}}},\"returnSchema\":{\"type\":\"object\",\"properties\":{\"result\":{\"type\":\"object\",\"properties\":{\"Documento\":{\"type\":\"string\"},\"Tipo\":{\"type\":\"string\"},\"Qtd\":{\"type\":\"number\"}}}}}}","apiInfo":"{\"variant\":\"synchronous\",\"variantVersion\":2}"}